
# a) Install Ghidra.

Ghidra Installed, and working. 

<img width="784" height="586" alt="image" src="https://github.com/user-attachments/assets/441e5fc4-e6b9-43e9-8bc9-ca9592a10d6e" />

# b) rever-C. Reverse engineer the packd binary to C language with Ghidra. Find the main program. Give variables descriptive names. Explain the program's operation.

I think the main program is called FUN_0010578d. The way I got to this solution was by analyzing entry, now entry according to this [source](https://medium.com/@jeanmichel.amblat/first-steps-with-ghidra-crackme01-319827a2e80b)  is where the program starts and usually will lead us to main.

So following the trail, from the Symbol tree I opened "Functions"

<img width="275" height="302" alt="image" src="https://github.com/user-attachments/assets/4be4b518-86db-4c3f-8e6d-22ba367bd364" />

* From functions I selected "entry"
* From Entry I saw there are 2 functions, 1 named FUN_00105988 other one, FUN_0010578d.
* This is the compiler view of the 88 ending one

<img width="930" height="458" alt="image" src="https://github.com/user-attachments/assets/915578fe-8cb0-4184-a516-68bba79575c1" />
* This was the compiler view of the 578d endint one

<img width="923" height="729" alt="image" src="https://github.com/user-attachments/assets/b6198b79-ba71-4c52-b49a-a5aba6e8a3f6" />

* From this I cant really know for sure which one is the main function.

According to another [article](https://medium.com/@greg-chapman/reveng-01-finding-main-in-32cdb8e1e9b5) I should usually find the main function by just filtering it

<img width="818" height="831" alt="image" src="https://github.com/user-attachments/assets/637533b9-7961-427c-8d6f-59149d161911" />

That did not work for me.

I did go trough every function manually, and I found one that had an undefined method, maybe this is the MAIN program?

<img width="521" height="403" alt="image" src="https://github.com/user-attachments/assets/6be1a668-3f3c-40e1-a42b-c08062230acf" />

I have no idea how to confirm if my assumption here is correct or not, so I leave this one open for now.

<img width="452" height="544" alt="image" src="https://github.com/user-attachments/assets/ccd0b3d8-30a8-4000-99ff-f2295958b894" />


From the main program, it seems like the function FUN_001053c7 takes in 2 parameters, one a memory address and the 2nd one a int locat_28 variable
*  FUN_001053c7(0x106394, local_28);
Then some kind of a comparison happens on the next line.
*  iVar1 = FUN_001053b7(local_28, 0x106399);

Looking at the first Function "FUN_001053c7", it seems like it does nothing? Atleast I am not able to pinpoint anything specific that it is doing.

<img width="816" height="321" alt="image" src="https://github.com/user-attachments/assets/7c7cf67b-7919-43dc-a450-588653ac68f3" />

Same goes for the other function

<img width="780" height="258" alt="image" src="https://github.com/user-attachments/assets/d70656f8-490f-4e98-9172-d4804de41c28" />

Then there is a check that will check that if 1Var1 matches 0 then it returs FUN_001053a7 with the memory address "0x1063a7", if it does not match then it will return FUN_001053a7(0x1063ed)

I am also renaming the undefined8 to int since it is returning a 0 in the end

<img width="670" height="238" alt="image" src="https://github.com/user-attachments/assets/3f0f8876-d96e-40f5-a9d5-ba87dae8c967" />


# c) If backwards. Modify the passtr program's binary (without the original source code) so that it accepts all passwords except the correct one. Demonstrate with tests that the program works. ezbin-challenges.zip

Based on h3 however I know that the main function is the where the password gets checked. I dont think I would have figured it out any other way.

Here, it took me some time to think this trough, after reading a bit online I came accross this article

In this article it instructed me to do something called "Patching assembly instructions".

<img width="1183" height="414" alt="image" src="https://github.com/user-attachments/assets/325dd10d-f7ed-4d7d-acc7-f934eedcb8d6" />

Following the instructions I selected the "if" on the decompiler

<img width="1271" height="658" alt="image" src="https://github.com/user-attachments/assets/257e5922-bf93-4008-b54f-483b15cba3ce" />

Here I right clicked the LAB_0010552d and selected "Patch Instruction"

<img width="940" height="471" alt="image" src="https://github.com/user-attachments/assets/b7af29ad-f745-4be3-92b6-bc7ab159eafa" />

Now I need to change the JNZ value to JZ  

<img width="637" height="175" alt="image" src="https://github.com/user-attachments/assets/591670e8-3076-4d89-88bf-09c87daa0be0" />

Done, now I export the binary to somewhere I can interact with it.

After exporting the binary and running it, I was able to run it, input an incorrect password and it gave me the flag.

<img width="869" height="120" alt="image" src="https://github.com/user-attachments/assets/53619024-6738-4025-9e7f-3fa9ee24ef45" />


# d) Nora CrackMe: Compile to binaries Tindall 2023: NoraCodes / crackmes. Read README.md: don't look at the source code unless you need training wheels. In these tasks, binaries are reverse engineered. Binaries are not modified, because otherwise the solution to every task would be to change the return value to "return 0".

Here I was really confused in what to do. After reading the tutorial for exactly 2 minutes, I realized I had to gcc the binary and then run it.

<img width="1118" height="66" alt="image" src="https://github.com/user-attachments/assets/1963359c-2798-4ff7-8856-bbb80d19a0e2" />


# e) Nora crackme01. Solve the binary.

The output clearly wants an "argument" so lets give it one

<img width="821" height="41" alt="image" src="https://github.com/user-attachments/assets/f52b8855-b13e-4d9b-a8fc-6022d915db4e" />

nub was not the correct input, so maybe we need to modify the code.

After opening the file with ghidra, I started to look around. 

I went straight for the main function, here I saw there is a variable __n that has a hardcoded string value of "password1".

<img width="368" height="160" alt="image" src="https://github.com/user-attachments/assets/84c1c7ea-144a-426d-b1cc-4cde72f27062" />

So lets try the password1

Password 1 was correct

<img width="793" height="60" alt="image" src="https://github.com/user-attachments/assets/334821fd-d027-4c26-ba46-224d2ed0ba01" />


# e) Nora crackme01e. Solve the binary.

Same thing, if u compile it and run it, the first thing that you will see is a "need exactly one argumetn".

So lets open it up in ghidra to see whats happening.

I see again there is an hardcoded value here

<img width="592" height="414" alt="image" src="https://github.com/user-attachments/assets/e94463b6-9ed5-4674-9f39-5166f2071ecc" />

but this hardcoded value did not get me anywhere

<img width="801" height="67" alt="image" src="https://github.com/user-attachments/assets/91677957-bbc5-4da9-8ded-ed194dc671fd" />

so I had to do something else here.

I looked around for atleast an hour until I realized that the hardcoded value should definently be the correct password, it even reads in the walktrough.

so after many tries, i realized you can put ' ' infront of the password itself to input it 

<img width="901" height="355" alt="image" src="https://github.com/user-attachments/assets/927deddd-9062-453c-bd81-24163c32b20e" />


# f) Nora crackme02. Name the main program's variables from the reverse-engineered binary and explain the program's operation. Solve the binary.

