TIETOKONE: Lenovo Thinkpad 

YMPÄRISTÖ: Oracle Virtualbox (OS) Kali Linux 10GB ram allocated

MISSÄ: HELSINKI,PASILA, (KOTI)

KELLONAIKA: 24-01-2026 20:00-22:00, 25-01-2026 08:30-11:00



# x) Read/watch/listen and summarize. (In this x-subsection, you don't need to do tests on a computer; just reading or listening and a summary is enough. A few bullet points are sufficient for the summary.)

## OWASP: OWASP Top 10: A01 Broken Access Control https://owasp.org/Top10/2021/A01_2021-Broken_Access_Control/index.html

* OWASP Top 10 Broken Access Control defines what broken access control means and the different ways vulnerabilities are found in broken access control
  * For example broken access control is getting access to certain parts of a webpage/database/application that you should not have access to
  * By modying the URL, page HTML, using an attack tool that modifies API requests, Elevation of priviledge (Acting as a user without being logged in) attackers can get into different parts of an application.

## Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf 

* fuff is a directory fuzzing tool that enables you to probe hidden directories (and even passwords, headers, etc...)
* Essentially what fuff does is that it 

## PortSwigger: Access control vulnerabilities and privilege escalation
* There are 3 distinct type of access control vulnerabilities
  * Vertical access controls
    * Different type of users have access to different application functions (probably the most commonly used).
  * Horizontal access controls
    *  Specific users have access to the same type of resource but will only be able to see their own resource not anyone elses.
  * Context-dependent access controls
    *  Restricts the users access to functions based on what is happening in the application at the current time.

## Karvinen 2006: Report Writing (in Finnish)

* A good report consists of the following things
  * Good documentation of the tasks (I.E screenshots and details of the problems that arise)
  * Computer that is used to execute the tasks
  * What commands are used in the task
  * Good documentation practices
  * Refer to sources and list them 

# a) Break into 010-staff-only. See Karvinen 2024: Hack'n Fix

I started this exercise by following the instructions on this website: https://terokarvinen.com/hack-n-fix/

What I did here is that we downloaded an module to unpack the zip file found in teros website.

<img width="1044" height="469" alt="image" src="https://github.com/user-attachments/assets/6027ba43-27fc-437b-9cda-a2faaa824383" />

Here I ran one of the files that I have to break in.

<img width="1040" height="421" alt="image" src="https://github.com/user-attachments/assets/1268ab33-ef32-4d33-9e5d-97ca6f39ebaf" />

After navigating to the localhost ip and the correct port i found this webpage 

<img width="1263" height="551" alt="image" src="https://github.com/user-attachments/assets/9abda87f-4a00-4c2e-869d-ec244cbe96a0" />

From here I really did not know what to do so I looked at the tips, from reading the tips I learned that I can use the dev tools (IMO it was unclear from the start that I can do this "Find the vulnerability trough the web interface, without looking at the source code." I suppose I need to expand my vocabulary to know the difference between source code and client side code.)

From the web GUI i looked trough what I could do, there was some SQL select queries on the webpage itself, so that gives you a clue that you have to do something with that SQL query. From this I could detuct that a. this probably has something to do with an SQL injection b. the input field is probably the place I want to do the SQL injection to.

I modified the query and then I tried to paste the Query into the field but it was only accepting numbers 

<img width="1337" height="897" alt="image" src="https://github.com/user-attachments/assets/bb3a85bc-9d09-4702-bfcf-2cc488da9dec" />

After thinking for some 10 minutes I notcied that on the field itself there is a "type = number" that probably is responsible for what type of value the input accepts.

So I changed the field type value to empty and tried to run the sql query

The only thing that I got from that was an internal server error 

<img width="1332" height="412" alt="image" src="https://github.com/user-attachments/assets/c42293ae-55a8-4615-a874-9d7b04bdcbd4" />

So back to the drawing board

From the classroom I remembered that you do not type in the whole sql query.

So I googled some common sql queries to try from this webpage https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet

There were some injections but I saw one that we used in the classroom: ' OR '1'='1

* The ' closes the opening quote that was meant for the pin value
* OR '1'='1' adds a new condition that is always true
* The remaining '; from the original code closes the statement

By injecting that I got the password "foo", which I assume here is correct. I do not have anything to test this againts to nor the webpage itself gave me any information on was this the correct answer or not.


(UPDATE, THIS CAME AFTER I LOOKED AT THE SOURCE CODE) I did not get the correct password, so I had to try more. Even tough I had seen the source code I dont really know what I was looking at so I could not extract any clues from it (besides the fact that i saw the pin of the admin)

I tried the following queries: 

' OR username='admin' --

' OR role='admin' --

' OR is_admin=1 --

All of these produced the same error. 

After reading the tips more, there was a metion of the LIMIT clause

Reading about it, "LIMIT" just limits to what is retrived from the database so 0 = first row form the index so on so on.

LIMIT = LIMIT [offset], [count]

So I tried different LIMIT combinations

' OR '1'='1' LIMIT 1,1

' OR '1'='1' LIMIT 2,1

So after trying iterating trough different LIMIT versions I ended up with the correct flag.

<img width="1311" height="631" alt="image" src="https://github.com/user-attachments/assets/edaf7c4d-fcbe-4b33-ae0a-ead896008019" />


# b) Fix the 010-staff-only vulnerability from source code. Demonstrate with a test that your solution works.

I used the command nano staff-only.py

<img width="821" height="105" alt="image" src="https://github.com/user-attachments/assets/b2ae6f83-281c-4ecc-8dad-83ab79f4f625" />

From here I could see the source code of the file itself. 

I do not know what I should look here so I had to google common sql injection fixes.

On this website there was mentioned that you cannot concatenate strings in a query.   https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html

But before I try this, I wantd to try something else (this probably is not the correct way to do this) but in python there exists a (isdigit)

But essentially if I add the isdigit check in the beginning of the code, this will always check if the input contains only digits, if not it will return flase

* if "pin" in request.form:
  *  pin = str(request.form['pin'])
   * if not pin.isdigit():
    *    return "lol nub nice try", 400
* else:
  *  pin = "0"
 
Now to think about it this is probably crackhead coding but im running out of time so it is what it is.

<img width="1327" height="440" alt="image" src="https://github.com/user-attachments/assets/a2b5529c-b878-4436-8a8d-0a0a409586c1" />


# c) Solve dirfuzt-1 from the article Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf. This helps in solving 020-your-eyes-only. 

Fuff installed 

<img width="707" height="516" alt="image" src="https://github.com/user-attachments/assets/26730e79-bc33-443f-8103-1dec0501ed59" />

<img width="703" height="502" alt="image" src="https://github.com/user-attachments/assets/e4f72a01-9f92-4fd9-9c49-0654bccda00c" />

Here I used following commands:

$ wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-1

$ chmod u+x dirfuzt-1

chmod = gives rights to the file

$ u + x = ownder / execute

$ ./dirfuzt-1 = name of the file that we are trying to run

I got my webpage to open dirfutz-1

<img width="1148" height="832" alt="image" src="https://github.com/user-attachments/assets/577b03fb-d6a6-4a1c-b014-acdff93acbd9" />


Here I tried to use fuff, with the command: ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ

ffuf = means the module itself that we are calling on the cli

$ -w = (Optional) (wordlist that contains the name of the directories)

$ common.txt = file that is used in the -w flag

$ -u = Target url

$ http://127.0.0.2:8000/FUZZ = URL

<img width="706" height="495" alt="image" src="https://github.com/user-attachments/assets/a52454f8-f176-4c65-8a87-1209b6c150d3" />

Here I did something wrong because fuff was really slow (40 mins), lets try again.

<img width="696" height="502" alt="image" src="https://github.com/user-attachments/assets/26e94040-d7bd-4607-8b98-44e7350a1693" />

Now I got alot of requests, just like in teros example i found that the common demoniter for these was 154, so I tried to filter that from the output.

I used the same command but now with the flag -fs 154 to filter.

<img width="694" height="487" alt="image" src="https://github.com/user-attachments/assets/1a79cbf6-ecda-4bbe-a6c7-c2db9e1c12e7" />


I got 12 matches, filtered the 178 aswell

<img width="659" height="55" alt="image" src="https://github.com/user-attachments/assets/f6f01edf-5222-44ae-9a1d-d7df798792f7" />

<img width="713" height="874" alt="image" src="https://github.com/user-attachments/assets/eec42887-c418-4851-a027-5ecf4a7e65d1" />
I found 2 interesting URLS from the output.

<img width="1564" height="848" alt="image" src="https://github.com/user-attachments/assets/a9f202c4-79e0-4d6e-95aa-8b150caffbe6" />

<img width="1584" height="837" alt="image" src="https://github.com/user-attachments/assets/c5382993-ce6e-40dc-b7ba-579eae0cb1b8" />


# d) Break into 020-your-eyes-only. See Karvinen 2024: Hack'n Fix

In this exercise I had to run a server on a virtual env, instructions can be found here https://terokarvinen.com/hack-n-fix/

<img width="1493" height="600" alt="image" src="https://github.com/user-attachments/assets/65311d08-2d68-4a76-830e-63fac0a3771f" />

Here I installed the virtualenv and got the server to work.

With the command ./manage.py runserver

# e) Fix the 020-your-eyes-only vulnerability. Demonstrate with a test that your solution works.
