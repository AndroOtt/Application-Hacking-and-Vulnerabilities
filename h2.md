# x) Read/watch/listen and summarize. (In this x-subsection, you don't need to do tests on a computer; just reading or listening and a summary is enough. A few bullet points are sufficient for the summary.)

## OWASP: OWASP Top 10: A01 Broken Access Control https://owasp.org/Top10/2021/A01_2021-Broken_Access_Control/index.html

* OWASP Top 10 Broken Access Control defines what broken access control means and the different ways vulnerabilities are found in broken access control
  * For example broken access control is getting access to certain parts of a webpage/database/application that you should not have access to
  * By modying the URL, page HTML, using an attack tool that modifies API requests, Elevation of priviledge (Acting as a user without being logged in) attackers can get into different parts of an application.

## Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf 

* fuff is a directory fuzzing tool that enables you to probe hidden directories (and even passwords, headers, etc...)
* Essentially what fuff does is that it 

## PortSwigger: Access control vulnerabilities and privilege escalation
* There are 3 distinct type of access control vulnerabilities
  * Vertical access controls
    * Different type of users have access to different application functions (probably the most commonly used).
  * Horizontal access controls
    *  Specific users have access to the same type of resource but will only be able to see their own resource not anyone elses.
  * Context-dependent access controls
    *  Restricts the users access to functions based on what is happening in the application at the current time.

## Karvinen 2006: Report Writing (in Finnish)

* A good report consists of the following things
  * Good documentation of the tasks (I.E screenshots and details of the problems that arise)
  * Computer that is used to execute the tasks
  * What commands are used in the task
  * Good documentation practices
  * Refer to sources and list them 

# a) Break into 010-staff-only. See Karvinen 2024: Hack'n Fix

I started this exercise by following the instructions on this website: https://terokarvinen.com/hack-n-fix/

What I did here is that we downloaded an module to unpack the zip file found in teros website.

<img width="1044" height="469" alt="image" src="https://github.com/user-attachments/assets/6027ba43-27fc-437b-9cda-a2faaa824383" />

Here I ran one of the files that I have to break in.

<img width="1040" height="421" alt="image" src="https://github.com/user-attachments/assets/1268ab33-ef32-4d33-9e5d-97ca6f39ebaf" />

After navigating to the localhost ip and the correct port i found this webpage 

<img width="1263" height="551" alt="image" src="https://github.com/user-attachments/assets/9abda87f-4a00-4c2e-869d-ec244cbe96a0" />

From here I really did not know what to do so I looked at the tips, from reading the tips I learned that I can use the dev tools (IMO it was unclear from the start that I can do this "Find the vulnerability trough the web interface, without looking at the source code." I suppose I need to expand my vocabulary to know the difference between source code and client side code.)

From the web GUI i looked trough what I could do, there was some SQL select queries on the webpage itself, so that gives you a clue that you have to do something with that SQL query. From this I could detuct that a. this probably has something to do with an SQL injection b. the input field is probably the place I want to do the SQL injection to.

I modified the query and then I tried to paste the Query into the field but it was only accepting numbers 

<img width="1337" height="897" alt="image" src="https://github.com/user-attachments/assets/bb3a85bc-9d09-4702-bfcf-2cc488da9dec" />

After thinking for some 10 minutes I notcied that on the field itself there is a "type = number" that probably is responsible for what type of value the input accepts.

So I changed the field type value to empty and tried to run the sql query

The only thing that I got from that was an internal server error 

<img width="1332" height="412" alt="image" src="https://github.com/user-attachments/assets/c42293ae-55a8-4615-a874-9d7b04bdcbd4" />

So back to the drawing board

From the classroom I remembered that you do not type in the whole sql query.

So I googled some common sql queries to try from this webpage https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet

There were some injections but I saw one that we used in the classroom: ' OR '1'='1

* The ' closes the opening quote that was meant for the pin value
* OR '1'='1' adds a new condition that is always true
* The remaining '; from the original code closes the statement

By injecting that I got the password "foo", which I assume here is correct. I do not have anything to test this againts to nor the webpage itself gave me any information on was this the correct answer or not.


(UPDATE, THIS CAME AFTER I LOOKED AT THE SOURCE CODE) I did not get the correct password, so I had to try more. Even tough I had seen the source code I dont really know what I was looking at so I could not extract any clues from it (besides the fact that i saw the pin of the admin)

I tried the following queries: 

' OR username='admin' --

' OR role='admin' --

' OR is_admin=1 --

All of these produced the same error. 

After reading the tips more, there was a metion of the LIMIT clause

Reading about it, "LIMIT" just limits to what is retrived from the database so 0 = first row form the index so on so on.

LIMIT = LIMIT [offset], [count]

So I tried different LIMIT combinations

' OR '1'='1' LIMIT 1,1

' OR '1'='1' LIMIT 2,1

So after trying iterating trough different LIMIT versions I ended up with the correct flag.

<img width="1311" height="631" alt="image" src="https://github.com/user-attachments/assets/edaf7c4d-fcbe-4b33-ae0a-ead896008019" />


# b) Fix the 010-staff-only vulnerability from source code. Demonstrate with a test that your solution works.

I used the command nano staff-only.py

<img width="821" height="105" alt="image" src="https://github.com/user-attachments/assets/b2ae6f83-281c-4ecc-8dad-83ab79f4f625" />

From here I could see the source code of the file itself. 

I do not know what I should look here so I had to google common sql injection fixes.

On this website there was mentioned that you cannot concatenate strings in a query.   https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html

But before I try this, I wantd to try something else (this probably is not the correct way to do this) but in python there exists a (isdigit)

But essentially if I add the isdigit check in the beginning of the code, this will always check if the input contains only digits, if not 

* if "pin" in request.form:
  *  pin = str(request.form['pin'])
   * if not pin.isdigit():
    *    return "lol nub nice try", 400
* else:
  *  pin = "0"

<img width="1327" height="440" alt="image" src="https://github.com/user-attachments/assets/a2b5529c-b878-4436-8a8d-0a0a409586c1" />


# c) Solve dirfuzt-1 from the article Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf. This helps in solving 020-your-eyes-only.

# d) Break into 020-your-eyes-only. See Karvinen 2024: Hack'n Fix

# e) Fix the 020-your-eyes-only vulnerability. Demonstrate with a test that your solution works.
